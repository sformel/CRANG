---
title: "codeCRANG_SF_edits"
author: "Stephen Formel"
date: "11/25/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

In this version I've gotten rid of Nate's code, added a line to remove any strange characters in the original data and added a variable to programatically separate out data by dataset.

```{r load libraries, message = FALSE}

library(knitr)
library(tidyverse)
library(readxl)
library(data.table)
library(lubridate)
library(magrittr)
library(scales)
library(reshape2)
library(stringr)
library(cowplot)

```

## Nate Code for loading and cleaning data

#CRANG CODE SO FAR:
```{r, eval = FALSE}


#Read CSVs and trim down

##First O2 Meter 0240

do0240Data=read.csv("Practice/do/11022020Test0240Fresh.csv",header=FALSE)
do0240Data2<-do0240Data[-c(1:22),]
do0240Data2$dateTime <- paste(do0240Data2$V1, do0240Data2$V2)
strptime(do0240Data2$dateTime, "%m/%d/%y %H:%M:%S")
do0240Data3 <- select(do0240Data2,6,13,20,27,35)
colnames(do0240Data3) <- c("OxygenCH1",	"OxygenCH2",	"OxygenCH3", "OxygenCH4", "DateTime")

##Second O2 Meter 0239
do0239Data=read.csv("11022020Test0239Fresh.csv",header=FALSE)
do0239Data2<-do0239Data[-c(1:22),]
do0239Data2$dateTime <- paste(do0239Data2$V1, do0239Data2$V2)
strptime(do0239Data2$dateTime, "%m/%d/%y %H:%M:%S")
do0239Data3 <- select(do0239Data2,6,35) 
colnames(do0239Data3) <- c("OxygenCH5","DateTime")
```


#Steve's Revisions
```{r }

#make list of files
FL <- list.files(path = "../Practice/do", full.names = TRUE)

set_name <- str_extract(FL, pattern = "Test*.*")
#read in data into list

O2.list <- lapply(FL, read.table, 
                  sep = ",",
                  skip = 21,
                  strip.white = TRUE,
                  header = TRUE)

#remove empty columns
O2.list <- lapply(O2.list, function(x){
  x <- Filter(function(y)!all(is.na(y)), x)
         })

#Remove Temp C column as it seems to match the temp of all channels, except Channel 2.  Not sure why that one is different, but it is.

O2.list <- lapply(O2.list, function(x) {
  x %>% select(-Temperature..degC.)
}) 

#gather into channels
O2.list <- lapply(O2.list, function(x) {
  gather(x, key = "Variable", value = "Value", Oxygen.CH.1:Temperature.CH.4)
})

#split Variable string for Channel info - from reshape2 pkg
O2.list <- lapply(O2.list, function(x) {
  y <- colsplit(x$Variable,"\\.",c("Variable","Channel"))
  x$Variable <- y$Variable
  x$Channel <- y$Channel
  return(x)
})

#spread
O2.list <- lapply(O2.list, function(x) {
  spread(x, key = Variable, value = Value)
})

#make time column
O2.list <- lapply(O2.list, function(x) {
  x$date_time <- as.POSIXct(strptime(paste(x$Date..DD.MM.YYYY., 
                            x$Time..HH.MM.SS.), 
                      format =  "%m/%d/%Y %I:%M:%S %p"))
  return(x)
})
  
#Combine Runs - gotta think on this for a programmatic solution

O2.list[[2]]$Channel <- paste0(O2.list[[2]]$Channel, ".2")

O2 <- rbindlist(O2.list) %>% 
  arrange(Channel, date_time)

```


## Nates code
```{r, eval = FALSE}

#Read reference file and split into incubation subsets
IncReference=read.csv("IncReference.csv",header=TRUE)
####why cant i make these bookends filter properly??????! Messing w my splitup of incubations. Character format, but i failed trying to convert to Pos..
Inc1<-IncReference$Inc1
IncTime<-IncReference$IncTime
Inc1End<-IncReference$Inc1End
Inc2<-IncReference$Inc2
Inc2End<-IncReference$Inc2End
Inc3<-IncReference$Inc3
Inc3End<-IncReference$Inc3End
Inc4<-IncReference$Inc4
Inc4End<-IncReference$Inc4End
Inc5<-IncReference$Inc5
Inc5End<-IncReference$Inc5End
Inc6<-IncReference$Inc6
Inc6End<-IncReference$Inc6End
Inc7<-IncReference$Inc7
Inc7End<-IncReference$Inc7End
Inc8<-IncReference$Inc8
Inc8End<-IncReference$Inc8End

Incubation1<-filter(do0240Data3,DateTime >= (Inc1) & DateTime <= (Inc1End))
Incubation2<-filter(do0240Data3,DateTime >= (Inc2) & DateTime <= (Inc2End))
Incubation3<-filter(do0240Data3,DateTime >= (Inc3) & DateTime <= (Inc3End))
Incubation4<-filter(do0240Data3,DateTime >= (Inc4) & DateTime <= (Inc4End))
Incubation5<-filter(do0240Data3,DateTime >= (Inc5) & DateTime <= (Inc5End))
Incubation6<-filter(do0240Data3,DateTime >= (Inc6) & DateTime <= (Inc6End))
Incubation7<-filter(do0240Data3,DateTime >= (Inc7) & DateTime <= (Inc7End))
Incubation8<-filter(do0240Data3,DateTime >= (Inc8) & DateTime <= (Inc8End))

#Do the split for incubations for 0239

Incubation1<-filter(do0240Data3,DateTime >= (Inc1) & DateTime <= (Inc1End))
Incubation2<-filter(do0240Data3,DateTime >= (Inc2) & DateTime <= (Inc2End))
Incubation3<-filter(do0240Data3,DateTime >= (Inc3) & DateTime <= (Inc3End))
Incubation4<-filter(do0240Data3,DateTime >= (Inc4) & DateTime <= (Inc4End))
Incubation5<-filter(do0240Data3,DateTime >= (Inc5) & DateTime <= (Inc5End))
Incubation6<-filter(do0240Data3,DateTime >= (Inc6) & DateTime <= (Inc6End))
Incubation7<-filter(do0240Data3,DateTime >= (Inc7) & DateTime <= (Inc7End))
Incubation8<-filter(do0240Data3,DateTime >= (Inc8) & DateTime <= (Inc8End))

```

## Steve code

```{r}

#Read reference file and split into incubation subsets
IncReference=read.csv("IncReference.csv",header=TRUE)

#better in this format
IncReference <- read.csv("IncReference_SF.csv",header=TRUE)

IncReference$Start <- as.POSIXct(IncReference$Start)
IncReference$Stop <- as.POSIXct(IncReference$Stop)

#may need to adjust to be inclusiv for bounds
overlap.function <- function(vals) {
  rowSums(mapply(function(a,b) between(vals, a, b), 
                 IncReference$Start, IncReference$Stop)) > 0
}


O2 <- O2 %>% 
  filter(overlap.function(O2$date_time))

#It appears as if Incubations 6-8 might have incorrect times

O2$Set <- ifelse(between(O2$date_time, 
                    lower = IncReference$Start[1], 
                    upper =  IncReference$Stop[1]),
                 yes = 1,
                 no = ifelse(between(O2$date_time, 
                    lower = IncReference$Start[2], 
                    upper =  IncReference$Stop[2]),
                 yes = 2,
                 no = ifelse(between(O2$date_time, 
                    lower = IncReference$Start[3], 
                    upper =  IncReference$Stop[3]),
                 yes = 3,
                 no = ifelse(between(O2$date_time, 
                    lower = IncReference$Start[4], 
                    upper =  IncReference$Stop[4]),
                 yes = 4,
                 no = ifelse(between(O2$date_time, 
                    lower = IncReference$Start[5], 
                    upper =  IncReference$Stop[5]),
                 yes = 5,
                 no = ifelse(between(O2$date_time, 
                    lower = IncReference$Start[6], 
                    upper =  IncReference$Stop[6]),
                 yes = 6,
                 no = ifelse(between(O2$date_time, 
                    lower = IncReference$Start[7], 
                    upper =  IncReference$Stop[7]),
                 yes = 7,
                 no = ifelse(between(O2$date_time, 
                    lower = IncReference$Start[8], 
                    upper =  IncReference$Stop[8]),
                 yes = 8,
                 no = NA)))))))) %>% 
  as.factor()

#Make Relative Time by Set
O2 <- O2 %>% 
  group_by(Set, Channel) %>% 
  mutate(Rel_Time = row_number()/2)

#Just to clean up plot and show Nate
O2$Channel <- plyr::revalue(O2$Channel, replace = c("CH.1" = "CH5",
                                                    "CH.1.2" = "CH1",
                                                    "CH.2.2" = "CH2",
                                                    "CH.3.2" = "CH3",
                                                    "CH.4.2" = "CH4"))
#Just to clean up plot and show Nate
O2$Set <- plyr::revalue(O2$Set, replace = c("1" = "Incubation 1",
                                                    "2" = "Incubation 2",
                                                    "3" = "Incubation 3",
                                                    "4" = "Incubation 4",
                                                    "5" = "Incubation 5"))

O2 %>%
  filter(!(Channel %in% c("CH.2", "CH.3", "CH.4"))) %>% 
ggplot(aes(x = Rel_Time,
           y = Oxygen,
           fill = Set)) +
  geom_point(shape = 21,
             alpha = 0.5) +
  facet_wrap(~ Channel, scales = "free") +
  geom_smooth(method = "lm",
              color = "black") +
  #scale_x_datetime(labels = date_format("%D \n %H:%M")) + 
  theme_bw() +
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 45, hjust = 1),
        panel.spacing = unit(2, "lines")) +
  labs(title = "Nate's Stuff",
       x = "Minutes",
       y = "Hot Ass O2",
       fill = "Incubations")

ggsave(filename = "test_plot.png", width = 5, height = 3, units = "in")

```

## Steve Code - stats

#Haven't worked on getting stats per incubation set yet, but it makes sense to me that you might want to think about a GLM for this to control for the random effect of Sensor.  There's some personal preference there in terms of the stats you might want to report.

```{r}
summary_stats <- function(x, cat_var, num_var){
  cat_var <- enquo(cat_var)
  num_var <- enquo(num_var)

  x %>%
    group_by(!!cat_var) %>%
    summarize(avg = mean(!!num_var), 
              n = n(), 
              sd = sd(!!num_var), 
              se = sd/sqrt(n),
              min = min(!!num_var),
              max = max(!!num_var))
}

sum.stats <- O2 %>%
  summary_stats(cat_var = Channel, num_var = Oxygen)

lm.stats <-  O2 %>%
  group_by(Channel) %>%
  do({
    result = lm(Oxygen ~ date_time, .)
    tibble(r_squared = 
                 result %>% 
                 summary %>% 
                 use_series(adj.r.squared),
               p_value = 
                 result %>% 
                 anova %>% 
                 use_series(`Pr(>F)`) %>% 
                 extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})

#Combine stats

all.stats <- inner_join(x = sum.stats, y = lm.stats )

#convert seconds to minute
all.stats$date_time <- all.stats$date_time*60

#change name to "slope"
#round
all.stats[,-1] <- lapply(all.stats[,-1], round, digits = 3)

#filter
all.stats <- all.stats %>% 
  filter(Channel %in% c("CH1", "CH2", "CH3", "CH4", "CH5"))

#view stats
kable(all.stats)

```


## Nate code

```{r, eval = FALSE}

#Get columns max and min for graphs
colMax <- sapply(Incubation1, max, na.rm = TRUE)
colMin <- sapply(Incubation1, min, na.rm = TRUE)
O2Max <- colMax[ -c(5,6) ]
O2Min <- colMin[ -c(5,6) ]
O2MaxY<-max(O2Max)
O2MinY<-min(O2Min)
O2MaxYN<-as.numeric(O2MaxY)
O2MinYN<-as.numeric(O2MinY)

#Stats for each CRANG DO
Inc1Ch1_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH1 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch2_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH2 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch3_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH3 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch4_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH4 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch5_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH5 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})

#Combine stats into a table
allStats1<- rbind(Inc1Ch1_Stats,Inc1Ch2_Stats,Inc1Ch3_Stats,Inc1Ch4_Stats,Inc1Ch5_Stats) 

#Rename slope column
allStats1a<-rename(allStats1,3,Slope = ID)

#Round R2 and Slope values???

#Create graphs of DO during incubations, 5 of DO, 1 table of all R2,P-value,and Slope

pdf("Incubation1.pdf")
attach(Incubation1b)
par(mfrow=c(2,3),oma = c(0, 0, 2, 0))
plot(Incubation1b$ID, Incubation1b$OxygenCH1, main="CRANG1",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH2, main="CRANG2",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH3, main="CRANG3",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH4, main="CRANG4",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH5, main="CRANG5",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
mtext("Dissolved Oxygen During Incubation1", outer = TRUE, cex = 1.5)
dev.off()

#Linear Regression/Trendline for each plot???

###Repeat O2 range to plot pdf for each incubation, gotta be a more concise way to code this.

#Incubation2
#Get columns max and min for graphs
colMax <- sapply(Incubation2, max, na.rm = TRUE)
colMin <- sapply(Incubation2, min, na.rm = TRUE)
O2Max <- colMax[ -c(5,6) ]
O2Min <- colMin[ -c(5,6) ]
O2MaxY<-max(O2Max)
O2MinY<-min(O2Min)
O2MaxYN<-as.numeric(O2MaxY)
O2MinYN<-as.numeric(O2MinY)

#Stats for each CRANG DO
Inc2Ch1_Stats <- Incubation2b %>%
  do({
    result = lm(OxygenCH1 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc2Ch2_Stats <-  Incubation2b %>%
  do({
    result = lm(OxygenCH2 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc2Ch3_Stats <- Incubation2b %>%
  do({
    result = lm(OxygenCH3 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc2Ch4_Stats <- Incubation2b %>%
  do({
    result = lm(OxygenCH4 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc2Ch5_Stats <- Incubation2b %>%
  do({
    result = lm(OxygenCH5 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})

#Combine stats into a table
allStats2<- rbind(Inc2Ch1_Stats,Inc2Ch2_Stats,Inc2Ch3_Stats,Inc2Ch4_Stats,Inc2Ch5_Stats) 

#Rename slope column
allStats2a<-rename(allStats2,3,Slope = ID)

#Round R2 and Slope values???

#Create graphs of DO during incubations, 5 of DO, 1 table of all R2,P-value,and Slope

pdf("Incubation2.pdf")
attach(Incubation2b)
par(mfrow=c(2,3),oma = c(0, 0, 2, 0))
plot(Incubation2b$ID, Incubation2b$OxygenCH1, main="CRANG1",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation2b$ID, Incubation2b$OxygenCH2, main="CRANG2",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation2b$ID, Incubation2b$OxygenCH3, main="CRANG3",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation2b$ID, Incubation2b$OxygenCH4, main="CRANG4",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation2b$ID, Incubation2b$OxygenCH5, main="CRANG5",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
mtext("Dissolved Oxygen During Incubation2", outer = TRUE, cex = 1.5)
dev.off()

#Incubation3
#Get columns max and min for graphs
colMax <- sapply(Incubation1, max, na.rm = TRUE)
colMin <- sapply(Incubation1, min, na.rm = TRUE)
O2Max <- colMax[ -c(5,6) ]
O2Min <- colMin[ -c(5,6) ]
O2MaxY<-max(O2Max)
O2MinY<-min(O2Min)
O2MaxYN<-as.numeric(O2MaxY)
O2MinYN<-as.numeric(O2MinY)

#Stats for each CRANG DO
Inc1Ch1_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH1 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch2_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH2 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch3_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH3 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch4_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH4 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch5_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH5 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})

#Combine stats into a table
allStats<- rbind(Inc1Ch1_Stats,Inc1Ch2_Stats,Inc1Ch3_Stats,Inc1Ch4_Stats,Inc1Ch5_Stats) 

#Rename slope column
allStats1<-rename(allStats,3,Slope = ID)

#Round R2 and Slope values???

#Create graphs of DO during incubations, 5 of DO, 1 table of all R2,P-value,and Slope

pdf("Incubation1.pdf")
attach(Incubation1b)
par(mfrow=c(2,3),oma = c(0, 0, 2, 0))
plot(Incubation1b$ID, Incubation1b$OxygenCH1, main="CRANG1",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH2, main="CRANG2",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH3, main="CRANG3",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH4, main="CRANG4",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH5, main="CRANG5",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
mtext("Dissolved Oxygen During Incubation1", outer = TRUE, cex = 1.5)
dev.off()

#Incubation2
#Get columns max and min for graphs
colMax <- sapply(Incubation1, max, na.rm = TRUE)
colMin <- sapply(Incubation1, min, na.rm = TRUE)
O2Max <- colMax[ -c(5,6) ]
O2Min <- colMin[ -c(5,6) ]
O2MaxY<-max(O2Max)
O2MinY<-min(O2Min)
O2MaxYN<-as.numeric(O2MaxY)
O2MinYN<-as.numeric(O2MinY)

#Stats for each CRANG DO
Inc1Ch1_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH1 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch2_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH2 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch3_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH3 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch4_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH4 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch5_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH5 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})

#Combine stats into a table
allStats<- rbind(Inc1Ch1_Stats,Inc1Ch2_Stats,Inc1Ch3_Stats,Inc1Ch4_Stats,Inc1Ch5_Stats) 

#Rename slope column
allStats1<-rename(allStats,3,Slope = ID)

#Round R2 and Slope values???

#Create graphs of DO during incubations, 5 of DO, 1 table of all R2,P-value,and Slope

pdf("Incubation1.pdf")
attach(Incubation1b)
par(mfrow=c(2,3),oma = c(0, 0, 2, 0))
plot(Incubation1b$ID, Incubation1b$OxygenCH1, main="CRANG1",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH2, main="CRANG2",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH3, main="CRANG3",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH4, main="CRANG4",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH5, main="CRANG5",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
mtext("Dissolved Oxygen During Incubation1", outer = TRUE, cex = 1.5)
dev.off()

#Incubation2
#Get columns max and min for graphs
colMax <- sapply(Incubation1, max, na.rm = TRUE)
colMin <- sapply(Incubation1, min, na.rm = TRUE)
O2Max <- colMax[ -c(5,6) ]
O2Min <- colMin[ -c(5,6) ]
O2MaxY<-max(O2Max)
O2MinY<-min(O2Min)
O2MaxYN<-as.numeric(O2MaxY)
O2MinYN<-as.numeric(O2MinY)

#Stats for each CRANG DO
Inc1Ch1_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH1 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch2_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH2 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch3_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH3 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch4_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH4 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch5_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH5 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})

#Combine stats into a table
allStats<- rbind(Inc1Ch1_Stats,Inc1Ch2_Stats,Inc1Ch3_Stats,Inc1Ch4_Stats,Inc1Ch5_Stats) 

#Rename slope column
allStats1<-rename(allStats,3,Slope = ID)

#Round R2 and Slope values???

#Create graphs of DO during incubations, 5 of DO, 1 table of all R2,P-value,and Slope

pdf("Incubation1.pdf")
attach(Incubation1b)
par(mfrow=c(2,3),oma = c(0, 0, 2, 0))
plot(Incubation1b$ID, Incubation1b$OxygenCH1, main="CRANG1",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH2, main="CRANG2",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH3, main="CRANG3",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH4, main="CRANG4",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH5, main="CRANG5",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
mtext("Dissolved Oxygen During Incubation1", outer = TRUE, cex = 1.5)
dev.off()

#Incubation2
#Get columns max and min for graphs
colMax <- sapply(Incubation1, max, na.rm = TRUE)
colMin <- sapply(Incubation1, min, na.rm = TRUE)
O2Max <- colMax[ -c(5,6) ]
O2Min <- colMin[ -c(5,6) ]
O2MaxY<-max(O2Max)
O2MinY<-min(O2Min)
O2MaxYN<-as.numeric(O2MaxY)
O2MinYN<-as.numeric(O2MinY)

#Stats for each CRANG DO
Inc1Ch1_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH1 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch2_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH2 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch3_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH3 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch4_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH4 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch5_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH5 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})

#Combine stats into a table
allStats<- rbind(Inc1Ch1_Stats,Inc1Ch2_Stats,Inc1Ch3_Stats,Inc1Ch4_Stats,Inc1Ch5_Stats) 

#Rename slope column
allStats1<-rename(allStats,3,Slope = ID)

#Round R2 and Slope values???

#Create graphs of DO during incubations, 5 of DO, 1 table of all R2,P-value,and Slope

pdf("Incubation1.pdf")
attach(Incubation1b)
par(mfrow=c(2,3),oma = c(0, 0, 2, 0))
plot(Incubation1b$ID, Incubation1b$OxygenCH1, main="CRANG1",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH2, main="CRANG2",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH3, main="CRANG3",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH4, main="CRANG4",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH5, main="CRANG5",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
mtext("Dissolved Oxygen During Incubation1", outer = TRUE, cex = 1.5)
dev.off()

#Incubation2
#Get columns max and min for graphs
colMax <- sapply(Incubation1, max, na.rm = TRUE)
colMin <- sapply(Incubation1, min, na.rm = TRUE)
O2Max <- colMax[ -c(5,6) ]
O2Min <- colMin[ -c(5,6) ]
O2MaxY<-max(O2Max)
O2MinY<-min(O2Min)
O2MaxYN<-as.numeric(O2MaxY)
O2MinYN<-as.numeric(O2MinY)

#Stats for each CRANG DO
Inc1Ch1_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH1 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch2_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH2 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch3_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH3 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch4_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH4 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch5_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH5 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})

#Combine stats into a table
allStats<- rbind(Inc1Ch1_Stats,Inc1Ch2_Stats,Inc1Ch3_Stats,Inc1Ch4_Stats,Inc1Ch5_Stats) 

#Rename slope column
allStats1<-rename(allStats,3,Slope = ID)

#Round R2 and Slope values???

#Create graphs of DO during incubations, 5 of DO, 1 table of all R2,P-value,and Slope

pdf("Incubation1.pdf")
attach(Incubation1b)
par(mfrow=c(2,3),oma = c(0, 0, 2, 0))
plot(Incubation1b$ID, Incubation1b$OxygenCH1, main="CRANG1",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH2, main="CRANG2",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH3, main="CRANG3",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH4, main="CRANG4",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH5, main="CRANG5",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
mtext("Dissolved Oxygen During Incubation1", outer = TRUE, cex = 1.5)
dev.off()

#Incubation2
#Get columns max and min for graphs
colMax <- sapply(Incubation1, max, na.rm = TRUE)
colMin <- sapply(Incubation1, min, na.rm = TRUE)
O2Max <- colMax[ -c(5,6) ]
O2Min <- colMin[ -c(5,6) ]
O2MaxY<-max(O2Max)
O2MinY<-min(O2Min)
O2MaxYN<-as.numeric(O2MaxY)
O2MinYN<-as.numeric(O2MinY)

#Stats for each CRANG DO
Inc1Ch1_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH1 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch2_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH2 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch3_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH3 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch4_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH4 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch5_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH5 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})

#Combine stats into a table
allStats<- rbind(Inc1Ch1_Stats,Inc1Ch2_Stats,Inc1Ch3_Stats,Inc1Ch4_Stats,Inc1Ch5_Stats) 

#Rename slope column
allStats1<-rename(allStats,3,Slope = ID)

#Round R2 and Slope values???

#Create graphs of DO during incubations, 5 of DO, 1 table of all R2,P-value,and Slope

pdf("Incubation1.pdf")
attach(Incubation1b)
par(mfrow=c(2,3),oma = c(0, 0, 2, 0))
plot(Incubation1b$ID, Incubation1b$OxygenCH1, main="CRANG1",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH2, main="CRANG2",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH3, main="CRANG3",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH4, main="CRANG4",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH5, main="CRANG5",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
mtext("Dissolved Oxygen During Incubation1", outer = TRUE, cex = 1.5)
dev.off()

#Incubation2
#Get columns max and min for graphs
colMax <- sapply(Incubation1, max, na.rm = TRUE)
colMin <- sapply(Incubation1, min, na.rm = TRUE)
O2Max <- colMax[ -c(5,6) ]
O2Min <- colMin[ -c(5,6) ]
O2MaxY<-max(O2Max)
O2MinY<-min(O2Min)
O2MaxYN<-as.numeric(O2MaxY)
O2MinYN<-as.numeric(O2MinY)

#Stats for each CRANG DO
Inc1Ch1_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH1 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch2_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH2 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch3_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH3 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch4_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH4 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})
Inc1Ch5_Stats <-  Incubation1b %>%
  do({
    result = lm(OxygenCH5 ~ ID, .)
    tibble(r_squared = 
             result %>% 
             summary %>% 
             use_series(adj.r.squared),
           p_value = 
             result %>% 
             anova %>% 
             use_series(`Pr(>F)`) %>% 
             extract2(1) ) %>%
      bind_cols(
        result %>%
          coef %>%
          as.list %>%
          as_tibble) %>%
      select(-`(Intercept)`)})

#Combine stats into a table
allStats<- rbind(Inc1Ch1_Stats,Inc1Ch2_Stats,Inc1Ch3_Stats,Inc1Ch4_Stats,Inc1Ch5_Stats) 

#Rename slope column
allStats1<-rename(allStats,3,Slope = ID)

#Round R2 and Slope values???

#Create graphs of DO during incubations, 5 of DO, 1 table of all R2,P-value,and Slope

pdf("Incubation1.pdf")
attach(Incubation1b)
par(mfrow=c(2,3),oma = c(0, 0, 2, 0))
plot(Incubation1b$ID, Incubation1b$OxygenCH1, main="CRANG1",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH2, main="CRANG2",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH3, main="CRANG3",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH4, main="CRANG4",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
plot(Incubation1b$ID, Incubation1b$OxygenCH5, main="CRANG5",xlab="SampleID",ylab="DO (mg/L)",pch=1,cex=0.5,ylim=c(O2MinYN,O2MaxYN))
mtext("Dissolved Oxygen During Incubation1", outer = TRUE, cex = 1.5)
dev.off()

```

